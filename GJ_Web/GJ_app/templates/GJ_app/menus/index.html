{% extends "base.html" %}
{% block content %}
	<style>
		dd {
			text-align:right;
		}
		
		.list-group-item.active, .list-group-item.active:focus, .list-group-item.active:hover {
			text-shadow:grey;
			background-image: linear-gradient(to bottom,grey 0,#5E5E5E 100%);
			border-color:grey;
		}
		

		h2 {font-family: 'Poiret One', cursive;}
		h5 { font-family: 'Poiret One', cursive;}
		legend { font-family: 'Poiret One', cursive}

		
		.GJButton{ border-color:#2C8A64; background-color: #2C8A64; background-image:none; outline:none;  font-family: 'Poiret One', cursive;}
		.GJButton:hover, .GJButton:focus, .GJButton:active { border-color: #/FED136; background-color: #FED136; transition:all 0.5s; outline:none;  font-family: 'Poiret One', cursive;}
		.btn-success{ border-color:#2C8A64; background-color: #2C8A64; background-image:none; outline:none; font-family: 'Poiret One', cursive;}
		.btn-success:hover , .btn-success:focus, .btn-success:active { border-color: #19E794; background-color: #19E794; transition:all 0.5s; outline:none; font-family: 'Poiret One', cursive;}
		
	</style>
	<section>
		<legend style="font-size:50px; text-align:center" > Menu Page  </legend>
		<div class="row">
			<div class="col-xs-12 col-md-2">
				<div style="text-align:center">
					<a class="btn btn-md btn-success GJButton" style="outline:none; font-weight:bold" id="addPop"
				data-container="body" data-toggle="popover" data-placement="bottom" data-trigger="hover" data-content="Add New Item" href="/GJ_app/addItem/{{comp_id}}/"> +</a>
				</div>
			</div>
			<div class="col-xs-12 col-md-8">
				<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
					{% for item in items %}
						<div class="panel panel-default">
							<div class="panel-heading" role="tab" id="heading-{{item.item_id.item_id}}">
								<h4 class="panel-title">
										<a role="button" data-toggle="collapse" data-parent="#accordion" href="#{{item.item_id.item_id}}" aria-expanded="true" aria-controls="nav-{{item.item_id.item_id}}">
											{{item.item_id.item_nickname}}
										</a>
									</h4>
							</div>
							<div id="{{item.item_id.item_id}}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading-{{item.item_id.item_id}}">
								<div class="panel-body">
									<p>
										<div class="dl-horizontal col-xs-12 col-md-6">
											<table class="table table-hover col-xs-12 col-md-6">
													<thead>
														<th> </th>
														<th> </th>
													</thead>
												<tbody>
													<tr>
														<td style="width:unset" >Base price (Subtotal Price before Sales tax)  </td>
														<td>${{item.item_id.realPrice}} </td>
													</tr>	
													<tr>
														<td style="width:unset"> Start Date </td>
														<td>{% if item.item_id.item_startDate < currentDate %}
																	Current Item
																{% elif  item.item_id.item_startDate == currentDate %}
																	Starts Today!
																{% else %}
																	{{item.item_id.item_startDate}}
																{% endif %}   
														</td>
													</tr>
													<tr>
														<td style="width:unset"> Start Time </td>
														<td>{% if item.item_id.item_startTime|stringformat:"s" == "02:00:00" %}
																	All-day Item
																{% else %}
																	{{item.item_id.item_startTime}}
																{% endif %}  </td>
													</tr>								
												</tbody>
											</table>
										</div>
										<div class="dl-horizontal col-xs-12 col-md-6">
											<table class="table table-hover col-xs-12 col-md-6">
												<thead>
													<th> </th>
													<th> </th>
												</thead>
												<tbody>
													<tr>
														<td style="width:unset"> Item Status </td>
														<td>{% if item.item_id.item_isActive == 1 %}
																	Active &nbsp;
																	<a class="btn-sm btn-danger" style="outline:none text-decoration:none;" href="/GJ_app/deactivateItem/{{item.item_id.item_id}}"> Deactivate</a>
																{% else %}
																	Inactive
																{% endif %}  
														</td>
													</tr>
													<tr>
														<td> End Date </td>
														<td>{% if item.item_id.item_endDate < currentDate %}
																	Item Ended
																{% elif  item.item_id.item_endDate == currentDate %}
																	Ends Today!
																{% elif  item.item_id.item_endDate == continDate %}
																	Continuous Item
																{% else %}
																	{{item.item_id.item_endDate}}
																{% endif %} 
														</td>
													</tr>
													<tr>
														<td style="width:unset"> End Time</td>
														<td>{% if item.item_id.item_endTime|stringformat:"s" == "02:00:00" %}
																	All-day Item
																{% else %}
																	{{item.item_id.item_endTime}}
																{% endif %} 
														</td>
													</tr>								
												</tbody>
											</table>
										</div>
									</p>
									<p>
										<div style="padding-top:7%">
											{% if item.item_id.item_isActive == 1 %}
												<button class="editForm btn btn-success" style="outline:none" role="button" data-toggle="modal" data-target="#editInfoModal-{{item.item_id.item_id}}"> Edit item info</button>
											{% else %}
												<a class="activate btn btn-success" style="outline:none" href="/GJ_app/activateItem/{{item.item_id.item_id}}" role="button"> Activate Item</a>
											{% endif %} 
												<button class="editIngredients btn btn-success" type="button" data-toggle="collapse" data-target="#moreDetails-{{item.item_id.item_id}}" aria-expanded="false" aria-controls="moreDetails-{{item.item_id.item_id}}"> More detailed info
												</button>
										</div>
									</p>
								</div>
							</div>
						</div>
						<div class="modal fade" id="editInfoModal-{{item.item_id.item_id}}" tabindex="-1" role="dialog" aria-labelledby="editItemInfo">
							<div class="modal-dialog" role="document">
								<div class="modal-content">
									<div class="modal-header">
										<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
										<h4 class="modal-title" id="editItemInfo">Item Info Form </h4>					
									</div>
									<div class="modal-body">
										<form action="/GJ_app/itemMainInfo/{{item.item_id.item_id}}/" method="POST"> {% csrf_token %}
											<div class="form-group">
												<label for="nickNameEdit">Item Nickname</label>
												<div class="input-group">
													<input class="form-control" name="nickNameEdit" value="{{item.item_id.item_nickname}}" placeholder="{{item.item_id.item_nickname}}">
												</div>
											</div>
											<div class="form-group">
												<label for="basePriceEdit">Base Price (Subtotal Price before Sales Tax)"</label>
												<div class="input-group">
													<div class="input-group-addon">$</div>
													<input class="form-control" name="basePriceEdit" value="{{item.item_id.realPrice}}" placeholder="{{item.item_id.realPrice}}">
												</div>
											</div>
											<div class="form-group">
												<label for="startDateEdit">Item Start Date</label>
												<div class='input-group date' id='datetimepicker1' data-date="{{item.item_id.item_startDate}}" data-date-format="dd-mm-yyyy" style="z-index:1050;">
													<input type='text' class="form-control" name="startDateEdit"  value="{{item.item_id.item_startDate}}" id="startDateEdit" />
													<span class="input-group-addon">
														<span class="glyphicon glyphicon-calendar"></span>
													</span>
												</div>
											</div>
											<div class="form-group">
												<label for="endDateEdit">Item End Date</label>
												<div class='input-group date' id='datetimepicker2'>
													<input type='text' class="form-control" name="endDateEdit" value= "{{item.item_id.item_endDate}}" placeholder="{{item.item_id.item_endDate}}"   id="endDateEdit" />
													<span class="input-group-addon">
														<span class="glyphicon glyphicon-calendar"></span>
													</span>
												</div>
											</div><div class="form-group">
												<label for="startTimeEdit">Item Start Time</label>
												<div class='input-group date' id='datetimepicker3'>
													<input type='text' class="form-control" name="startTimeEdit" value= "{{item.item_id.item_startTime}}" placeholder="{{item.item_id.item_endDate}}"   id="startTimeEdit" />
													<span class="input-group-addon">
														<span class="glyphicon glyphicon-calendar"></span>
													</span>
												</div>
											</div><div class="form-group">
												<label for="endTimeEdit">Item End Time</label>
												<div class='input-group date' id='datetimepicker4'>
													<input type='text' class="form-control" name="endTimeEdit" value= "{{item.item_id.item_endTime}}" placeholder="{{item.item_id.item_endTime}}"   id="endTimeEdit" />
													<span class="input-group-addon">
														<span class="glyphicon glyphicon-calendar"></span>
													</span>
												</div>
											</div>
											
											<div class="modal-footer">
												<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
												<button type="submit" class="btn btn-primary" name="changeItemInfo">Save changes</button>
											</div>
										</form>
									</div>
								</div>
							</div>				
						</div>
						<div class="collapse" id ="moreDetails-{{item.item_id.item_id}}" style="overflow:auto">
							<p>
								<div class="dl-horizontal col-xs-12 col-md-8">
										<table class="table table-hover col-xs-12 col-md-6">
										<thead>
											<th> </th>
											<th> </th>
										</thead>
										<tbody>
											<tr>
												<td style="width:unset" > Item Category </td>
												<td>{{item.category_id.category_name}} </td>
											</tr>
											<tr>
												<td style="width:unset" > Main Ingredient </td>
												<td>{{item.mainItems}} </td>
											</tr>
											<tr>
												<td style="width:unset"> Item Container </td>
												<td> {{item.container_id.container_name}}</td>
											</tr>
											<tr>
												<td> Item Size </td>
												<td>{{item.itemSizes}}</td>
											</tr>
											<tr>
												<td style="width:unset"> Fixed Ingredients </td>
												<td>{{item.fixedItems}} </td>
											</tr>
											<tr>
												<td style="width:unset"> Optional Ingredients </td>
												<td>{{item.optionalItems}} </td>
											</tr>
											<tr>
												<td style="width:unset"> Meal Options</td>
												<td>{{item.mealOptions}}</td>
											</tr>												
										</tbody>
									</table>
								</div>
							</p>
							<p>
								<div style="padding-top:7%">
									{% if item.item_id.item_isActive == 1 %}
										<a class="editForm btn btn-success" style="outline:none" href="" role="button"> Edit Item Details</a>
									{% endif %}
								</div>
							</p>
						</div>
					{% endfor %}
				</div>
			</div>
		</div>
	</section>
	
	
	
	<script>
		$(document).ready(function () {
			$(".menuitems a").on("click", function() {
				$(".menuitems a").removeClass("active");
				$(this).addClass("active");
				id = this.id.substring(4, this.id.length)
				$('.dynamic_link').hide();
				$('#content-'+id).show();
				
			});
			
			 $('#datetimepicker1').datepicker()
				.on('changeDate', function(ev){
					$('#datetimepicker1').datepicker('hide');
			 });	
			
			$("#addPop").popover({ trigger: "hover" });
			
		});
		
	   
	</script>
	
	
<!-- 				$(".editForm").on("click", function() {
				$("#basePriceEdit").prop("disabled", false) ;
				$("#startDateEdit").prop("disabled", false) ;
				$("#endDateEdit").prop("disabled", false) ;
				$("#startTimeEdit").prop("disabled", false) ;
				$("#endTimeEdit").prop("disabled", false) ;
			});
			
			$(".false").on("click", function() {
				$("#basePriceEdit").prop("disabled", true) ;
				$("#startDateEdit").prop("disabled", true) ;
				$("#endDateEdit").prop("disabled", true) ;
				$("#startTimeEdit").prop("disabled", true) ;
				$("#endTimeEdit").prop("disabled", true) ;
			});
			
						$('#activateItem').on('click' , function(e){
				e.preventDefault();
				console.log($(this).attr("value"));  // sanity check
				$.ajax({
					url : "activateItem", // the endpoint
					type : "POST", // http method
					data : { the_post : $('#post-text').val() }, // data sent with the post request

					// handle a successful response
					success : function(json) {
						$('#post-text').val(''); // remove the value from the input
						console.log(json); // log the returned json to the console
						console.log("success"); // another sanity check
					},

					// handle a non-successful response
					error : function(xhr,errmsg,err) {
						$('#results').html("<div class='alert-box alert radius' data-alert>Oops! We have encountered an error: "+errmsg+
							" <a href='#' class='close'>&times;</a></div>"); // add the error to the dom
						console.log(xhr.status + ": " + xhr.responseText); // provide a bit more info about the error to the console
					}
				});
			 -->
	
	
	
	
	
	
{% endblock %}
